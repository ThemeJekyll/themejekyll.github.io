$(document).ready(function(){var a;var b=new LazyLoad();imgLoaded=false;var c=$(document).scrollTop();$(".button-collapse").sideNav();$(".modal").modal();$("select").material_select();$("#slideout-close").on("click",function(){$(".button-collapse").sideNav("hide")});$.getJSON("https://themejekyll-chromatical.rhcloud.com/",function(g){var e=g;$("#loader").hide();Handlebars.registerHelper("gt",function(C,B,A){if(C>=B){return A.fn(this)}return A.inverse(this)});Handlebars.registerHelper("lt",function(C,B,A){if(C<B){return A.fn(this)}return A.inverse(this)});var f=Handlebars.compile($("#themeTemplate").html());var l=Handlebars.compile($("#themePageTemplate").html());var w=Handlebars.compile($("#featureTemplate").html());var o=Handlebars.compile($("#categoryTemplate").html());var t=Handlebars.compile($("#layoutTemplate").html());var q=Handlebars.compile($("#ratingTemplate").html());function y(B){var A=_.sortBy(B,function(H){return H.stars[0]}).reverse();var G=[];var E=[];var D=[];var C=_.pluck($(".chips-autocomplete").material_chip("data"),"tag");var F=$("#rating .filter:checked").attr("data-rating");$("#features :checkbox:checked").each(function(H,I){G.push($(I).attr("data-name"))});$("#categories :checkbox:checked").each(function(H,I){E.push($(I).attr("data-name"))});$("#layouts :checkbox:checked").each(function(H,I){D.push($(I).attr("data-name"))});A=_.filter(A,function(H){return _.every(G,function(I){return _.contains(H.features,I)})});A=_.filter(A,function(H){return _.every(E,function(I){return _.contains(H.categories,I)})});A=_.filter(A,function(H){return _.every(D,function(I){return _.contains(H.layouts,I)})});A=_.filter(A,function(H){return _.every(C,function(I){return _.contains(H.tags,I)})});A=_.filter(A,function(H){return s.include(String(H.title).toLowerCase(),$("#searchBox").val().toLowerCase())});A=_.filter(A,function(H){return H.stars[0]>=F});return A}function d(B,C){var A=B;switch(C){case"featured":A=_.sortBy(A.reverse(),"featured").reverse();break;case"name":A=_.sortBy(A,"title");break;case"rating":A=_.sortBy(A,function(D){return D.stars[0]}).reverse();break;case"popularity":A=_.sortBy(A,function(D){return D.stars[6]}).reverse();break;case"newest":A=_.sortBy(A,"date").reverse();break;case"oldest":A=_.sortBy(A,"date");break}return A}function u(A){return f(A)}function j(B,C,A){var D=$("<div>");B.slice(C,A).forEach(function(E){$(D).append(u(E))});$("#themeView").append($(D).html());if(B.length>A){$(".load-more").show()}else{$(".load-more").hide()}if(imgLoaded){b.update()}}function v(A){$.ajax({url:"https://themejekyll-chromatical.rhcloud.com/update",data:JSON.stringify({url:A}),method:"POST",contentType:"application/json",success:function(C){var B=_.findIndex(e,{url:A});if(B!==-1){e[B]=C;if($("#"+A+"-theme").length>0){$("#"+A+"-theme").html($(u(e[B])).html());b.update()}}}})}function x(){$(document).scrollTop(0);$("#themeView").empty()}function i(){$("#searchBox").val("");$("#filters").find(".any-rating").click();$(".chips-autocomplete .chip .close").click();$("#filters").find(":checkbox:checked").prop("checked",false);k()}function z(B,A){switch(B){case"feature":$("#features").append(w(A));break;case"category":$("#categories").append(o(A));break;case"layout":$("#layouts").append(t(A));break}}function h(A){$("#features :checkbox").each(function(B,C){if(!_.contains(A.features,$(C).attr("data-name"))){$(C).attr("disabled",true)}else{$(C).removeAttr("disabled")}});$("#categories :checkbox").each(function(B,C){if(!_.contains(A.categories,$(C).attr("data-name"))){$(C).attr("disabled",true)}else{$(C).removeAttr("disabled")}});$("#layouts :checkbox").each(function(B,C){if(!_.contains(A.layouts,$(C).attr("data-name"))){$(C).attr("disabled",true)}else{$(C).removeAttr("disabled")}})}var k=function(){var A=d(y(e),$("#sortSelect").val());x();if(A.length>0){$("#noThemesFound").hide();j(A,0,30)}else{$("#noThemesFound").show()}h({features:_.uniq(_.flatten(_.pluck(A,"features"))),categories:_.uniq(_.flatten(_.pluck(A,"categories"))),layouts:_.uniq(_.flatten(_.pluck(A,"layouts")))})};function m(B){c=$(document).scrollTop();var A=_.where(e,{url:B})[0];$("body").removeClass("home").addClass("show-theme");$("#theme-wrapper").empty().html(l(A));$("title").text(A.title+" | ThemeJekyll - Jekyll Themes Gallery");$("#theme-wrapper").show();$(document).scrollTop(0);a=new Swiper(".swiper-container",{pagination:".swiper-pagination",paginationClickable:true,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",loop:true})}function n(){$("body").removeClass("show-theme").addClass("home");$("#theme-wrapper").fadeOut(function(){a.destroy();$("#theme-wrapper").empty();$("title").text("ThemeJekyll - Jekyll Themes Gallery")});$(document).scrollTop(c)}$("#filters-clear").on("click",function(){i()});$(document).on("change",".filter",function(){k()});$("#searchBox").on("input",function(){k()});$("#sortSelect").on("change",function(){k()});$("#showMore").on("click",function(){var A=$(".theme").length;j(d(y(e)),A,A+30)});$(document).on("click","#back-to-themes",function(A){A.preventDefault();history.back()});$(document).on("click",".theme-url",function(A){A.preventDefault();history.pushState($(this).attr("href"),"",$(this).attr("href"));m($(this).attr("data-theme"))});$(window).on("popstate",function(A){console.log(A);if(A.target.location.href===window.location.origin+"/themes/"){n()}else{if(_.last(A.target.window.location.href)!=="#"&&A.target.window.location.hash[0]!=="#"){m(_.last(A.target.location.href.split("/"),2)[1])}}});$("#theme-wrapper").on("mouseover",".rating-star",function(){var A=$(this);$(A).parent().find(".rating-star").each(function(B,C){if($(C).attr("data-rating")<=$(A).attr("data-rating")){$(C).text("star")}else{$(C).text("star_border")}})});$("#theme-wrapper").on("mouseleave",".rating-star",function(){$(".rating-star").each(function(A,B){$(B).text($(B).attr("data-original"))})});$("#theme-wrapper").on("click",".rating-star",function(){$.ajax({url:"https://themejekyll-chromatical.rhcloud.com/star",data:JSON.stringify({url:$("#ratings").attr("data-url"),stars:$(this).attr("data-rating")}),method:"POST",contentType:"application/json",success:function(){p()},error:function(A){if(A.status===403){$("#ratingError").slideDown().delay(5000).slideUp()}}})});function p(){$.ajax({url:"https://themejekyll-chromatical.rhcloud.com/stars",data:JSON.stringify({url:$("#ratings").attr("data-url")}),method:"POST",contentType:"application/json",success:function(A){$("#ratings").html(q(JSON.parse(A)));v($("#ratings").attr("data-url"))}})}_.uniq(_.flatten(_.pluck(e,"features"))).sort().forEach(function(A){z("feature",{idslug:s.slugify(A),name:A})});_.uniq(_.flatten(_.pluck(e,"categories"))).sort().forEach(function(A){z("category",{idslug:s.slugify(A),name:A})});_.uniq(_.flatten(_.pluck(e,"layouts"))).sort().forEach(function(A){z("layout",{idslug:s.slugify(A),name:A})});var r=_.uniq(_.flatten(_.pluck(e,"tags")));$(".chips-autocomplete").material_chip({autocompleteOptions:{data:_.object(r,[]),limit:Infinity,minLength:1},secondaryPlaceholder:"+tag"});$(".chips-autocomplete").on("chip.add",function(B,A){if(!_.contains(r,A.tag)){$(".chips-autocomplete .chip .close").last().click()}else{k()}});$(".chips-autocomplete").on("chip.delete",function(B,A){k()});k();$("#themeView").imagesLoaded(function(){imgLoaded=true;b.update()})}).fail(function(){$("#loader").fadeOut(function(){$("#loadFailed").show()})})});